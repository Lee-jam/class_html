<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="membership.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>회원 가입 테스트</title>

  </head>

  <body>
    <form action="" name="myform">
      <div class="header">
        <header>
          <p>
            <b>NAMBI</b>
          </p>
        </header>
      </div>
      <div class="div1">
        <table>
          <tr >
            <td colspan="2" class="top">
              <h2>회원정보
                <span class="text-danger"> (필수)</span>
                <span style="color: red; text-align: right; font-size: 10px;">(* 필수 항목)</span>
              </h2>
            </td>
          </tr>
          <tr>
            <td class="item">
              <span style="color: red;">*</span><label for="name" style="font-size: 1vw;">이 름</label>
              </td>
            <td class="contents">
              <input type="text" id="name" size="5vw" onchange="name_check()">
            </td>
          </tr>
          <tr>
            <td class="item">
              <span style="color: red;">*</span><label for="userid" style="font-size: 1vw;">아 이 디</label>
            </td>
            <td class="contents">
              <input type="text" name="userid" id="user_id" size="20px" pattern="([a-z0-9_]{6,15}$)" onchange="check_id1()">
              <input type="button" value="중복확인" id="Checkid" onclick="check_id2()" class="btn btn-success">
              <span id="check1" class="checked"></span>
            </td>
          </tr>
          <tr>
            <td class="item">
              <span style="color: red;">*</span><label for="" style="font-size: 1vw;">비 밀 번 호</label>
          </td>
            <td class="contents">
              <input type="password" name="PW1" id="pwd" size="20px" onchange="checkpwd_1()">
              <span id="checkPW" class="checked"></span>
            </td>
          </tr>
          <tr>
            <td class="item">
              <span style="color: red;">*</span><label for="" style="font-size: 1vw;">비 밀 번 호 확인</label>
            </td>
            <td class="contents">
              <input type="password" name="PW2" id="checkpwd" size="20px" onchange="checkpwd_1()"> 
              <span id="check" class="checked"></span></td>
            <!-- onchange 속성: 이는 키보드로 입력 후 변화가 생겼을 때 발생하는 이벤트를 의미 -->
            <!-- name, id, function_name이 겹치지않도록 지정해주는 것이 좋음 -->
          </tr>
          <tr>
            <td class="item">
              <span style="color: red;">*</span><label for="RRN" style="font-size: 1vw;">주민등록번호</label>
            </td>
            <td class="contents">
              <input type="text" maxlength="6" placeholder="xxxxxx" id="fnum" onkeyup="autoJoo()">-<input type="text" name="joo" id="num" maxlength="1" placeholder="x" onkeyup="autoJoo()"><span>xxxxxx</span>
            </td>
          </tr>
          <tr>
            <td class="item">
              <label for="gender" style="font-size: 1vw;">성 별</label>
            </td>
            <td class="contents">
              <input type="radio" name="gender" id="man" value="0" onclick="return false">남
              <input type="radio" name="gender" id="woman" value="1" onclick="return false">여</td>
              <!-- type radio는 같은 공간내의 radio 중 1개만 선택이 됨 -->
              <!-- radio는 readonly가 먹히지 않기 때문에 onclick="return false" : 클릭시 false 값을 반환하여 수동으로 바뀌지않도록 함 -->
          </tr>
          <tr>
            <td class="item">
              <label for="email" style="font-size: 1vw;">이메일</label>
            </td>
            <td class="contents">
              <input type="text" name="mail_id" id="email_id" style="width: 8vw;"> @ 
              <input type="text" name="mail_mail" id="email1" style="width: 8vw;">
                <select name="selt_email" id="selectem" onchange="emailinput()">
                  <option value="1">직 접 입 력</option>
                  <option value="naver.com">naver.com</option>
                  <option value="google.com">google.com</option>
                  <option value="gmail.com">gmail.com</option>
                </select>
            </td>
          </tr>
          <tr>
            <td class="item">
              <label for="phone" style="font-size: 1vw;">휴 대 전 화</label>
            </td>
            <td class="contents">
              <select name="" id="trsel" onchange="autoPH()">
                <option value="KT">KT</option>
                <option value="SKT">SKT</option>
                <option value="LG">LG</option>
              </select>
              <select name="" id="phsel" onchange="autoPH()">
                <option value="010">010</option>
                <option value="011">011</option>
                <option value="070">070</option>
              </select>-<input type="text" name="phone1" maxlength="4" id="phoneInput1" onkeyup="autoPH()">-<input type="text" name="phone2" maxlength="4" id="phoneInput2">
              <input type="button" value="인증번호 받기" class="btn btn-success">
            </td>
          </tr>
          <tr>
            <td colspan="2" class="endswitch">
              <input type="button" name="send" id="send" class="btn btn-secondary" onclick="sendweb();" value="완료">
            </td>
          </tr>
        </table>
      </div>
      <div class="footer">
        <footer>
          <span>
            <a href="#" class="foot">이용약관</a>
          </span>
          <span>
            <a href="#" class="foot">
              <b>개인정보처리방침</b>
            </a>
          </span><br>
          <p style="color: gray; font-family: Cambria; font-size: 1vw;">Made In Korea. Maker Lee Jam</p>
        </footer>
      </div>
    </form>
    <script>
      var named = document.getElementById("name");
      var nm = document.getElementById("name");
      var id = document.getElementById('user_id');
      var check_id = document.getElementById("check1");
      var pwdd = document.getElementById("pwd");
      var checkpwdd = document.getElementById("checkpwd");
      var PWcheck = document.getElementById("checkPW");
      var okpw =document.getElementById("check");
      var phone_num1 = document.getElementById("phoneInput1");
      var phone_num2 = document.getElementById("phoneInput2");
      var fjoonum = document.getElementById("fnum");
      var joonum = document.getElementById("num");
      var eid = document.getElementById("email_id");

      function combine(str){
        var reg1 = /[a-z0-9]/;
        var reg2 = /[a-z]/;    
        var reg3 = /[0-9]/;
        return(reg1.test(str) && reg2.test(str) && reg3.test(str));
      }
  
      function name_check(){
        var reg = /[가-힣]/;
        var reg1 = /[ㄱ-ㅎ]/;
        if(named !=""){
          if(!reg.test(named.value) || reg1.test(named.value) || combine(name.value)){
            alert("한글로 입력해주세요.");
            named.value="";
            named.focus();
          }
          else if(named.value.length > 6){
            alert("이름이 6자 이내로 입력하세요.");
            named.value="";
            named.focus();
          }
          else{
            named.value = named.value;
          }
        }
      }
  
      function check_id1(){
        if(id.value !=""){
          if(id.value.length <6 || 15<id.value.length || combine(id.value) == false){
            check_id.innerHTML = "<span style='color:red'>아이디 형식에 맞춰주세요.(영문,숫자 조합 6~15자)</span>";
          }
        }
        else{
            check_id.innerHTML = "";
          }
      }
  
      // 코드 리팩토링 (띄워쓰기, 코드 간격, 불필요한 소스제거 및 수정, 쿼테이션은 싱글, 더블 둘 중 하나만...)
      function check_id2() {
        // ↓ 형식상의 아이디 중복확인 (내부 function 으로 옮김.)
        var idcheck = ["abcde123", "idsss123", "idsss456", "qwer1234"];
        // dom 객체를 선언하여 사용함.
        var id = document.getElementById("user_id");
        // 기존의 루프로 검사하는 것을 제거.
        var id_ck = idcheck.indexOf(id.value) > -1 ? true : false;
        // ex) a.indexOf(b) : a라는 배열 내에 b라는 값이 존재하는지 확인하여 존재하지 않으면 -1, 존재하면 위치 값을 반환함.
        if (id.value !== "") {
          if (6 < id.value.length && id.value.length < 15 && combine(id.value)) {
            if (!id_ck) {
              alert("사용가능한 아이디입니다.");
              // innerHTML 하나로 가능.
              check_id.innerHTML = "<span style='color:blue'>사용가능한 아이디입니다.</span>";
              // id 가 완료되면 pwd 로 포커스 되도록 추가.
              pwdd.focus();
            }
            else {
              alert("중복된 아이디입니다.")
              id.value = "";
              id.focus();
            }
          }
          else {
            alert("형식에 맞지않습니다.")
            id.value = "";
            id.focus();
          }
        }
      }
      // 코드 리팩토링
  
      function checkpwd_1() {
        var SC = ["!", "@", "#", "$", "%", "*"];
        var check_SC = 0;
  
        for(var i = 0; i < SC.length; i++) {
          if(pwdd.value.indexOf(SC[i]) != -1){
            check_SC = 1;
          }
        }
        if(pwdd.value){
          if(pwdd.value.length <= 8 || check_SC == 0 || !combine(pwdd.value)){
            PWcheck.innerHTML = "<span style='color:red'>영문, 숫자, 특수문자(필수) 조합 8자 이상</span>";
          }
          else{
            PWcheck.innerHTML = "<span style='color:orange'>안전한 비밀번호입니다.</span>";
          }
        }
        else{
          PWcheck.innerHTML = "";
        }
        if(pwdd.value && checkpwdd.value){
          if(pwdd.value === checkpwdd.value){
            okpw.innerHTML = "<span style='color:blue'>비밀번호가 일치합니다.</span>";
          }
          else{
            okpw.innerHTML = "<span style='color:red'>비밀번호가 일치하지 않습니다.</span>";
          }
        }
        else{
          okpw.innerHTML = "";
        }
      }
  
      function emailinput(){
        if(document.getElementById("selectem").value == "1"){
          document.getElementById("email1").value = "";
          document.getElementById("email1").readOnly = false;
        }
        else{
          document.getElementById("email1").value = document.getElementById("selectem").value;
          document.getElementById("email1").readOnly = true;
        }
      }
  
      function autoPH(){
        var telecom = document.getElementById("trsel");
        var phone_sel = document.getElementById("phsel");
        if(telecom.value){
          phone_sel.focus();
        }
        if(phone_sel.value){
          phone_num1.focus();
        }
        if(phone_num1.value.length == 4){
          phone_num2.focus();
        }
      }
      function autoJoo(){  
        if(fjoonum.value.length == 6){
          joonum.focus();
        }
        if(joonum.value.length == 1){
          joomin();
        }
      }
      // 주민번호 등록 시 앞자리에 따라 생년월일 입력, 뒷자리에 따라 성별 입력 (뒷자리 첫숫자가 1,3일때 남, 2,4일때 여)
      function joomin(){
        var ma = document.getElementById("man");
        var fe = document.getElementById("woman");
        jen = joonum.value;
        
        if(jen.charAt(0) === "1" || jen.charAt(0) ==="3"){
          ma.checked = true;
          fe.checked = false;
          eid.focus();
        }
        else if(jen.charAt(0) === "2" || jen.charAt(0) ==="4"){
          ma.checked = false;
          fe.checked = true;
          eid.focus();
        }
        else{
          ma.checked = false;
          fe.checked = false;
        }
      }
      function sendweb(){
        if(!named.value){
          alert("이름을 입력하세요");
          named.focus();
        }
        else{
          if(!id.value || !check_id.innerHTML){
            alert("아이디 입력 및 중복확인을 해주세요.");
            id.focus();
          }
          else{
            if(!pwdd.value || !okpw.innerHTML){
              alert("비밀번호가 잘못되었습니다.");
              pwdd.focus();
            }
            else{
              if(!fjoonum.value || !joonum.value){
                alert("주민등록번호를 입력해주세요.");
                fjoonum.focus();
              }
              else{
                alert("회원가입을 완료하였습니다.");
                window.location.href="nextscreen1.html";
              }
            }
          }
        }
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  </body>
</html>